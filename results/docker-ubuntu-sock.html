<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- This file was created with the aha Ansi HTML Adapter. https://github.com/theZiz/aha -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="application/xml+xhtml; charset=UTF-8"/>
<title>results/docker-ubuntu-sock.log</title>
</head>
<body style="color:white; background-color:black">
<pre>

<span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">                      ##</span><span style="font-weight:bold;color:white;">         .
</span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">                ## ## ##</span><span style="font-weight:bold;color:white;">        ==
</span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">             ## ## ## ##</span><span style="font-weight:bold;color:white;">       ===
         /&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;\___/ ===
</span><span style="font-weight:bold;color:#3333FF;">    ~~~ </span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">{</span><span style="font-weight:bold;color:#3333FF;">~~ ~~~~ ~~~ ~~~~ ~~~ ~</span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;"> /  </span><span style="font-weight:bold;color:white;">===-</span><span style="font-weight:bold;color:#3333FF;"> ~~~</span>
<span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">         \______ X           __/
           \    \         __/
            \____\_______/</span>
          __
     ____/ /__  ___  ____  ________
    / __  / _ \/ _ \/ __ \/ ___/ _ \ <span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">  ENUMERATE</span>
   / /_/ /  __/  __/ /_/ / (__/  __/ <span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;"> ESCALATE</span>
   \__,_/\___/\___/ .___/\___/\___/<span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">  ESCAPE</span>
                 /_/

 Docker Enumeration, Escalation of Privileges and Container Escapes (DEEPCE)
 by stealthcopter

<span style="font-weight:bold;color:#3333FF;">==========================================</span><span style="font-weight:bold;color:lime;">( Colors )</span><span style="font-weight:bold;color:#3333FF;">==========================================</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Exploit Test ............ </span><span style="background-color:red;">Exploitable - Check this out</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Basic Test .............. </span><span style="font-weight:bold;color:yellow;">Positive Result</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Another Test ............ </span><span style="font-weight:bold;color:red;">Error running check</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Negative Test ........... </span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">No</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Multi line test ......... </span><span style="font-weight:bold;color:yellow;">Yes</span>
<span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">Command output
spanning multiple lines</span>

<span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">Tips will look like this and often contains links with additional info. You can usually 
ctrl+click links in modern terminal to open in a browser window
See </span><span style="text-decoration:underline;font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">https://stealthcopter.github.io/deepce</span>

<span style="font-weight:bold;color:#3333FF;">===================================</span><span style="font-weight:bold;color:lime;">( Enumerating Platform )</span><span style="font-weight:bold;color:#3333FF;">===================================</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Inside Container ........ </span><span style="font-weight:bold;color:yellow;">Yes</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Container Platform ...... </span><span style="font-weight:bold;color:yellow;">docker</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Container tools ......... </span><span style="font-weight:bold;color:red;">None</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> User .................... </span><span style="font-weight:bold;color:yellow;">root</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Groups .................. </span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;"></span><span style="font-weight:bold;color:white;"></span><span style="font-weight:bold;color:white;background-color:red;">root</span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;"></span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Docker Executable ....... </span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">Not Found</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Docker Sock ............. </span><span style="font-weight:bold;color:yellow;">Yes</span>
<span style="font-weight:bold;color:white;">srw-rw---- 1 root 123 0 Aug 16 13:39 /var/run/docker.sock</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Sock is writable ........ </span><span style="background-color:red;">Yes</span>
<span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">The docker sock is writable, we should be able to enumerate docker, create containers 
and obtain root privs on the host machine
See </span><span style="text-decoration:underline;font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">https://stealthcopter.github.io/deepce/guides/docker-sock.md</span>

<span style="font-weight:bold;color:red;">Could not interact with the docker sock, as curl is not installed</span>
<span style="font-weight:bold;color:red;">curl is required but not installed</span>
<span style="font-weight:bold;color:red;">apt install -y curl</span>

<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Docker Version .......... </span><span style="font-weight:bold;color:red;">Version Unknown</span>
<span style="font-weight:bold;color:#3333FF;">==================================</span><span style="font-weight:bold;color:lime;">( Enumerating Container )</span><span style="font-weight:bold;color:#3333FF;">===================================</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Container ID ............ </span><span style="font-weight:bold;color:yellow;">dc73fe4eba45</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Container Full ID ....... </span><span style="font-weight:bold;color:yellow;">/</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Container Name .......... </span><span style="font-weight:bold;color:red;">Could not get container name through reverse DNS</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Container IP ............ </span><span style="font-weight:bold;color:yellow;">172.17.0.2 </span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> DNS Server(s) ........... </span><span style="font-weight:bold;color:yellow;">168.63.129.16 </span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Host IP ................. </span><span style="font-weight:bold;color:yellow;">172.17.0.1</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Operating System ........ </span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">GNU/Linux</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Kernel .................. </span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">5.15.0-1042-azure</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Arch .................... </span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">x86_64</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> CPU ..................... </span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">Intel(R) Xeon(R) Platinum 8171M CPU @ 2.60GHz</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Useful tools installed .. </span><span style="font-weight:bold;color:yellow;">Yes</span>
<span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">/usr/bin/hostname</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Dangerous Capabilities .. </span><span style="font-weight:bold;color:red;">capsh not installed, listing raw capabilities</span>
<span style="font-weight:bold;color:red;">libcap2-bin is required but not installed</span>
<span style="font-weight:bold;color:red;">apt install -y libcap2-bin</span>

<span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">Current capabilities are:</span>
<span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">CapInh:	0000000000000000
CapPrm:	00000000a80425fb
CapEff:	00000000a80425fb
CapBnd:	00000000a80425fb
CapAmb:	0000000000000000</span>
<span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">&gt; This can be decoded with: &quot;capsh --decode=00000000a80425fb&quot;</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> SSHD Service ............ </span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">No</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Privileged Mode ......... </span><span style="font-weight:bold;color:red;">Unknown</span>
<span style="font-weight:bold;color:#3333FF;">====================================</span><span style="font-weight:bold;color:lime;">( Enumerating Mounts )</span><span style="font-weight:bold;color:#3333FF;">====================================</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Docker sock mounted ....... </span><span style="background-color:red;">Yes</span>
<span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">The docker sock is writable, we should be able to enumerate docker, create containers 
and obtain root privs on the host machine
See </span><span style="text-decoration:underline;font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">https://stealthcopter.github.io/deepce/guides/docker-sock.md</span>

<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Other mounts .............. </span><span style="font-weight:bold;color:yellow;">Yes</span>
<span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">/home/runner/work/deepce/deepce/deepce.sh /root/deepce.sh rw,relatime - ext4 /dev/root rw,discard,errors=remount-ro</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Possible host usernames ... </span><span style="font-weight:bold;color:yellow;">runner </span>
<span style="font-weight:bold;color:#3333FF;">====================================</span><span style="font-weight:bold;color:lime;">( Interesting Files )</span><span style="font-weight:bold;color:#3333FF;">=====================================</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Interesting environment variables ... </span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">No</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Any common entrypoint files ......... </span><span style="font-weight:bold;color:yellow;">Yes</span>
<span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">-rwxr-xr-x 1 1001 123 38K Aug 16 13:39 /root/deepce.sh</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Interesting files in root ........... </span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">No</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Passwords in common files ........... </span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">No</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Home directories .................... </span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">No</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Hashes in shadow file ............... </span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">No permissions</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Searching for app dirs .............. </span>
<span style="font-weight:bold;color:#3333FF;">==================================</span><span style="font-weight:bold;color:lime;">( Enumerating Containers )</span><span style="font-weight:bold;color:#3333FF;">==================================</span>
<span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">By default containers can communicate with other containers on the same network and the 
host machine, this can be used to enumerate further</span>

<span style="font-weight:bold;color:red;"></span>TODO Enumerate container using sock
<span style="font-weight:bold;color:#3333FF;">===============================================</span><span style="font-weight:bold;color:lime;"></span><span style="font-weight:bold;color:#3333FF;">===============================================</span>
</pre>
</body>
</html>
